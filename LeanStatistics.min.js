AV.init({appId:config.APP_ID,appKey:config.APP_KEY});var query=new AV.Query(config.ClasS);var url=$(config.el).attr("id");var title=$(config.el).attr("title");var t=query.equalTo('url',url);query.find().then(function(results){if(results.length==0){addView(url,title)}else if(results.length>0){var Views=results[0].get('view');var ObjectID=results[0].get('objectId');updateView("Counter",ObjectID,Views)}},function(error){console.error(error)});function updateView(counter,id,view){var todo=AV.Object.createWithoutData(counter,id);var updatedView=view+1;todo.set('view',updatedView);todo.save();$(config.el).text(updatedView)}function addView(url,title){var Counter=AV.Object.extend(config.ClasS);var counter=new Counter();counter.set({'title':title,'url':url,'view':1});counter.set('priority',1);counter.save().then(function(todo){$(config.el).text(1)},function(error){console.error(error)})}localStorage.clear('debug','leancloud*');
